---
title: "Article graph"
author: "John Coene"
date: 2019-07-09T00:00:00+02:00
categories: ["R"]
tags: ["R Markdown", "weforum"]
---



<p>r-newsâ€™ first blog post ðŸŽ‰</p>
<p>In this blog post we gather coverage on <a href="https://en.wikipedia.org/wiki/2019_Hong_Kong_anti-extradition_bill_protests">anti-extradition bill protests</a> taking place in Honk Kong to build a Latent Dirichlet Allocation model.</p>
<p>First we collect 1,000 articles on the protests using <a href="https://webhoser.news-r.org/">webhoser</a>.</p>
<pre class="r"><code>library(webhoser)

hk_articles &lt;- wh_news(
    q = &#39;&quot;Hong Kong&quot; AND (&quot;protest&quot; OR &quot;protests&quot;) is_first:true language:english site_type:news&#39;,
    ts = (Sys.time() - (30 * 24 * 60 * 60))
  ) %&gt;% 
  wh_paginate(9) %&gt;% #Â 9 pages + initial query
  wh_collect()</code></pre>
<p>This returns 10 pages of results (an initial query and additional 9 pages). We can clean up the documents; we</p>
<pre class="r"><code>library(gensimr)

# preprocess
corpus &lt;- preprocess(hk_articles$text)
dictionary &lt;- corpora_dictionary(corpus)
corpora &lt;- doc2bow(dictionary, corpus)

# matrix market
corpus_mm &lt;- serialize_mmcorpus(corpora)

# tf-idf
tfidf_model &lt;- model_tfidf(corpus_mm)
corpus_tfidf &lt;- wrap(tfidf_model, corpora)

# build model
lda_model &lt;- model_lda(
  corpus_tfidf,
  id2word = dictionary, 
  num_topics = 50L,
  iterations = 200L
)

(lda_topics &lt;- lda_model$get_document_topics(corpora))
## &lt;gensim.interfaces.TransformedCorpus&gt;</code></pre>
